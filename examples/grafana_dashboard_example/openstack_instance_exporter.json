{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": 59,
  "links": [],
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 68,
      "panels": [],
      "title": "Exporter Overview",
      "type": "row"
    },
    {
      "description": "Current Prometheus alerts related to the OpenStack Instance Exporter job.",
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 7,
        "w": 6,
        "x": 0,
        "y": 1
      },
      "id": 69,
      "options": {
        "alertInstanceLabelFilter": "{job=openstack-instance-exporter}",
        "alertName": "",
        "dashboardAlerts": false,
        "groupBy": [],
        "groupMode": "default",
        "maxItems": 20,
        "showInactiveAlerts": false,
        "sortOrder": 1,
        "stateFilter": {
          "error": true,
          "firing": true,
          "noData": false,
          "normal": false,
          "pending": true,
          "recovering": true
        },
        "viewMode": "stat"
      },
      "pluginVersion": "12.3.0",
      "title": "Current Active Exporter Alerts",
      "type": "alertlist"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Public/gateway IPs on hypervisors that appear on any enabled threat list during the selected time window. Used with ovn-bgp-agent.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisGridShow": true,
            "axisLabel": "Listed",
            "axisPlacement": "auto",
            "axisSoftMax": 1,
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "stepAfter",
            "lineStyle": {
              "fill": "solid"
            },
            "lineWidth": 2,
            "pointSize": 3,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "percentage",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "orange",
                "value": 70
              },
              {
                "color": "red",
                "value": 85
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 7,
        "w": 18,
        "x": 6,
        "y": 1
      },
      "id": 67,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "maxHeight": 600,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "max_over_time(oie_host_threat_listed{instance=~\"$gvar_oie_hypervisor\"}[$__range])",
          "legendFormat": "{{ list }} | {{ ip }} ({{ family }})",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Environment Threat Detected Public IPs",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 8
      },
      "id": 910,
      "panels": [],
      "title": "Exporter Health",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "How long Prometheus takes to scrape each exporter.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-GrYlRd"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Seconds",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "barAlignment": 0,
            "barWidthFactor": 0.4,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 3,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "max": 0.5,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 9
      },
      "id": 912,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "scrape_duration_seconds{job=\"openstack-instance-exporter\", instance=~\"$gvar_oie_hypervisor\"}",
          "legendFormat": "{{ instance }}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Exporter Scrape Duration",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Samples scraped from each exporter (sanity for cardinality drift).",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Samples",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 3,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 9
      },
      "id": 913,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "scrape_samples_scraped{job=\"openstack-instance-exporter\", instance=~\"$gvar_oie_hypervisor\"}",
          "legendFormat": "{{ instance }}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Exporter Scrape Samples",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Exporter scrape status per hypervisor (1 = up).",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-RdYlGr"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Up",
            "axisPlacement": "auto",
            "axisSoftMax": 1,
            "axisSoftMin": 0,
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 1,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "decimals": 0,
          "mappings": [],
          "max": 1,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 17
      },
      "id": 911,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "up{job=\"openstack-instance-exporter\", instance=~\"$gvar_oie_hypervisor\"}",
          "legendFormat": "{{ instance }}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Exporter Up (per Hypervisor)",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "How long the entire process took to run per background collection cycle. Provides insight to exporter performance.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-GrYlRd"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Seconds",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "barAlignment": 0,
            "barWidthFactor": 0.4,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 3,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "max": 0.5,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 17
      },
      "id": 1219,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "oie_host_collection_duration_seconds{job=\"openstack-instance-exporter\", instance=~\"$gvar_oie_hypervisor\"}",
          "legendFormat": "{{ instance }}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Background Collection Cycle Time",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "How long the exporter background conntrack collection process has taken.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-GrYlRd"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Seconds",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "barAlignment": 0,
            "barWidthFactor": 0.4,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 3,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "max": 0.5,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 25
      },
      "id": 1220,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "oie_host_conntrack_read_duration_seconds{job=\"openstack-instance-exporter\", instance=~\"$gvar_oie_hypervisor\"}",
          "legendFormat": "{{ instance }}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Conntrack Background Collection Cycle Time",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "How long the exporter background libvirt collection process has taken.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-GrYlRd"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Seconds",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "barAlignment": 0,
            "barWidthFactor": 0.4,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 3,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "max": 0.5,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 25
      },
      "id": 1218,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "oie_host_libvirt_list_duration_seconds{job=\"openstack-instance-exporter\", instance=~\"$gvar_oie_hypervisor\"}",
          "legendFormat": "{{ instance }}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Libvirt Background Collector Duration",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Current static cache entries per host.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Count",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "barAlignment": 0,
            "barWidthFactor": 0.4,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 3,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "none"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 33
      },
      "id": 1222,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "oie_static_cache_entries{job=\"openstack-instance-exporter\", instance=~\"$gvar_oie_hypervisor\"}",
          "legendFormat": "{{ instance }}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Static Cache Entries",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Current dynamic cache entries per host.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Count",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "barAlignment": 0,
            "barWidthFactor": 0.4,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 3,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "none"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 33
      },
      "id": 1223,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "oie_dynamic_cache_entries{job=\"openstack-instance-exporter\", instance=~\"$gvar_oie_hypervisor\"}",
          "legendFormat": "{{ instance }}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Dynamic Cache Entries",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Seconds spent on the last cache cleanup run on this host.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-GrYlRd"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Seconds",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "barAlignment": 0,
            "barWidthFactor": 0.4,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 3,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "max": 0.5,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 41
      },
      "id": 1221,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "oie_cache_cleanup_duration_seconds{job=\"openstack-instance-exporter\", instance=~\"$gvar_oie_hypervisor\"}",
          "legendFormat": "{{ instance }}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Cache Cleanup Time",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Internal Error Logging for Collector",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-GrYlRd"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Count",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "decimals": 0,
          "mappings": [],
          "min": 1,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "none"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 41
      },
      "id": 1211,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "editorMode": "code",
          "expr": "increase(oie_host_collection_errors_total{job=\"openstack-instance-exporter\", instance=~\"$gvar_oie_hypervisor\"}[$__rate_interval])\n",
          "legendFormat": "{{ instance }}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Exporter Internal Collection Errors",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "CPU time used between collection cycles.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-GrYlRd"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Seconds",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "barAlignment": 0,
            "barWidthFactor": 0.4,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 3,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "decimals": 1,
          "mappings": [],
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 49
      },
      "id": 1225,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "increase(process_cpu_seconds_total{job=\"openstack-instance-exporter\"}[$__rate_interval])",
          "legendFormat": "{{ instance }}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "CPU Seconds per Collection Cycle",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "description": "Currently used ram by exporter.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-GrYlRd"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Memory",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "barAlignment": 0,
            "barWidthFactor": 0.4,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 3,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "decimals": 2,
          "mappings": [],
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          },
          "unit": "decbytes"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 49
      },
      "id": 1226,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "process_resident_memory_bytes{job=\"openstack-instance-exporter\"}",
          "legendFormat": "{{ instance }}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Exporter RSS (Resident Memory)",
      "type": "timeseries"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 57
      },
      "id": 950,
      "panels": [
        {
          "datasource": {
            "uid": "${datasource}"
          },
          "description": "Current amount of vCPUs allocated by hypervisor.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "vCPUs",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 58
          },
          "id": 1212,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Last *",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "editorMode": "code",
              "exemplar": false,
              "expr": "sum by (instance) (\noie_host_active_vcpus{job=\"openstack-instance-exporter\", instance=~\"$gvar_oie_hypervisor\"}\n)\n",
              "format": "time_series",
              "instant": false,
              "legendFormat": "Hypervisor : {{ instance }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "vCPUs Allocation by Hypervisor",
          "type": "timeseries"
        },
        {
          "datasource": {
            "uid": "${datasource}"
          },
          "description": "Current amount of Ram allocated by hypervisor.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Memory",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "decgbytes"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 58
          },
          "id": 1214,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Last *",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "editorMode": "code",
              "expr": "sum by (instance) (\noie_host_active_mem_gbytes{job=\"openstack-instance-exporter\", instance=~\"$gvar_oie_hypervisor\"}\n)\n",
              "legendFormat": "Hypervisor : {{ instance }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Instance Ram Allocation by Hypervisor",
          "type": "timeseries"
        },
        {
          "datasource": {
            "uid": "${datasource}"
          },
          "description": "Count of used flavors by Popularity.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic-by-name"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Count",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "decimals": 0,
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 67
          },
          "id": 1217,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Last *",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "editorMode": "code",
              "expr": "count by (flavor) (\n  oie_instance_info{project_uuid=~\"$gvar_oie_project_uuid\"}\n)\n",
              "legendFormat": "Flavor: {{ flavor }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Environment Flavors by Popularity",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Instances breaching any primary threshold (CPU/Disk/Net PPS).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisGridShow": true,
                "axisLabel": "Hot (1=breach)",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 3,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 75
          },
          "id": 951,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "max by (instance_uuid, project_uuid) (\n  (avg_over_time(oie_cpu_percent{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m]) > 75)\n  or (irate(oie_disk_w_requests{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1m]) > oie_disk_w_alert_threshold)\n  or (irate(oie_disk_r_requests{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1m]) > oie_disk_r_alert_threshold)\n  or (min_over_time(rate(oie_net_rx_pkt_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])[1m:]) > 3000)\n  or (min_over_time(rate(oie_net_tx_pkt_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])[1m:]) > 3000)\n)\n",
              "legendFormat": "Hot | Instance {{ instance_uuid }} | Project {{ project_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Hot Instances (Any Threshold Breached)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Top threat-intel contact bursts in the last hour, grouped by project (noise-filtered).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisGridShow": true,
                "axisLabel": "Hits / 1h",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 3,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 75
          },
          "id": 952,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "topk(100, sum by (project_uuid) (\n  increase(oie_tor_exit_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n+ increase(oie_tor_relay_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n+ increase(oie_spamhaus_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n+ increase(oie_emergingthreats_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n+ increase(oie_customlist_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n)) > $gvar_oie_min_contact\n",
              "legendFormat": "Threat hits | Project {{ project_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Threat Hits Last 1h (Top 100 by Project)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Top outbound flow counts by instance over the last exporter interval (shown only when flows exceed 1k).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisGridShow": true,
                "axisLabel": "Flows",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 3,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 15000
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 83
          },
          "id": 955,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "topk(100, sum by (instance_uuid, project_uuid) (oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"})) > 1000",
              "legendFormat": "Outbound flows | Instance {{ instance_uuid }} | Project {{ project_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Outbound Flows by Instance (Top 100, active now)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Single-target dominance candidates, ranked by flows (triage view).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-RdYlGr"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisGridShow": true,
                "axisLabel": "Ranked flows",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 3,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 91
          },
          "id": 954,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "topk(50, (\n  oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}\n  * on(instance_uuid, project_uuid, ip)\n  (\n    (oie_outbound_max_flows_single_remote{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}\n     /\n     oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}) > 0.8\n    and on(instance_uuid, project_uuid, ip)\n    (oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"} > 2000)\n  )\n))\n",
              "legendFormat": "Single-target dominance | IP {{ ip }} | Instance {{ instance_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Potential C2 / Single-Target Flood (Top 50, active now)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Scan/fan-out candidates active now (triage view).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisGridShow": true,
                "axisLabel": "Candidate Likelihood %",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 3,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "percent"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 91
          },
          "id": 953,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Last",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "topk(50,\n  (\n    100 *\n    oie_outbound_max_flows_single_remote{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}\n    /\n    oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}\n  )\n  and on(instance_uuid, project_uuid, ip)\n    (oie_outbound_unique_remotes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"} > 50)\n  and on(instance_uuid, project_uuid, ip)\n    (oie_outbound_unique_dst_ports{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"} > 50)\n  and on(instance_uuid, project_uuid, ip)\n    (oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"} > $gvar_oie_min_flows)\n)\n",
              "legendFormat": "Fan-out candidate | IP {{ ip }} | Instance {{ instance_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Outbound Scan / Fan-out (Top 50, active now)",
          "type": "timeseries"
        }
      ],
      "title": "Quick Overview",
      "type": "row"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 58
      },
      "id": 1200,
      "panels": [
        {
          "datasource": {
            "uid": "${datasource}"
          },
          "description": "Current amount of vCPUs allocated by project. Project Name and UUID.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "vCPUs",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 59
          },
          "id": 1215,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Last *",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "editorMode": "code",
              "expr": "sum by (project_uuid, project_name) (\n  label_replace(\n    oie_instance_info{instance=~\"$gvar_oie_hypervisor\"},\n    \"vcpus_num\",\n    \"$1\",\n    \"vcpus\",\n    \"([0-9]+)\"\n  )\n)\n",
              "legendFormat": "Project: {{project_name}} - {{project_uuid}}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "vCPUs Allocation by Project",
          "type": "timeseries"
        },
        {
          "datasource": {
            "uid": "${datasource}"
          },
          "description": "Current amount of Ram allocated by project. Project Name and UUID.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Memory",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "decgbytes"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 59
          },
          "id": 1216,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Last *",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "editorMode": "code",
              "expr": "sum by (project_uuid, project_name) (\n  label_replace(\n    oie_instance_info{instance=~\"$gvar_oie_hypervisor\"},\n    \"mem_mb_num\",\n    \"$1\",\n    \"mem_mb\",\n    \"([0-9]+)\"\n  )\n)\n",
              "legendFormat": "Project: {{project_name}} - {{project_uuid}}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Ram Allocation by Project",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Top projects by average CPU percent (5m smoothing).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "CPU Usage",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 68
          },
          "id": 1201,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "topk(100, avg by (project_uuid) (avg_over_time(oie_cpu_percent{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}[5m])))",
              "legendFormat": "{{project_uuid}}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Project CPU Burn (avg)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Top projects by disk IOPS (read+write requests per second). Greater than 200 to filter out low noise.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "IOPS",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  }
                ]
              },
              "unit": "iops"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 68
          },
          "id": 1202,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "topk(100, sum by (project_uuid) (rate(oie_disk_r_requests{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}[1m]) + rate(oie_disk_w_requests{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}[1m]))) > 200",
              "legendFormat": "{{project_uuid}}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Project Disk IOPS (r+w req/s)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Top projects by packet rate (rx+tx packets/s) Greater than 500 to filter out low noise.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "PPS",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "pps"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 76
          },
          "id": 1204,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "topk(100, sum by (project_uuid) (\n  rate(oie_net_rx_pkt_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}[5m])\n+ rate(oie_net_tx_pkt_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}[5m])\n)) > 500\n",
              "legendFormat": "{{project_uuid}}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Project Network PPS (rx+tx)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Top projects by throughput (rx+tx Gbit/s from gbytes metrics). Greater than 100Mbit to filter out low noise.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "last"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Throughput",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 0.8
                  }
                ]
              },
              "unit": "Gbits"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 76
          },
          "id": 1205,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "topk(\n  100,\n  sum by (project_uuid) (\n    (rate(oie_net_rx_gbytes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}[5m])\n    + rate(oie_net_tx_gbytes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}[5m]))\n    * 8\n  )\n) > 0.1",
              "legendFormat": "{{project_uuid}}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Project Network Throughput (rx+tx)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Top projects by total conntrack flows across all fixed IPs.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Connections",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 84
          },
          "id": 1206,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "topk(100, sum by (project_uuid) (oie_conntrack_ip_flows_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}))",
              "legendFormat": "{{project_uuid}}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Project Conntrack Pressure (total flows)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Top projects by outbound unique remotes, filtered to fixed IPs with meaningful flow volume.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Count",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 84
          },
          "id": 1207,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "expr": "topk(100, sum by (project_uuid) (oie_outbound_unique_remotes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"} and on (instance_uuid, project_uuid, ip) (oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"} > bool $gvar_oie_min_flows)))",
              "legendFormat": "{{project_uuid}}",
              "refId": "A"
            }
          ],
          "title": "Project Outbound Fan-out (unique remotes)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Top projects by new remote churn, filtered to fixed IPs with meaningful flow volume.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Count",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 92
          },
          "id": 1208,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "topk(100, sum by (project_uuid) (oie_outbound_new_remotes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"} and on (instance_uuid, project_uuid, ip) (oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"} > bool $gvar_oie_min_flows)))",
              "legendFormat": "{{project_uuid}}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Project New Remote Bursts",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Counts fixed IPs per project where >80% of flows go to one remote, with chatter filtered.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Count",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 92
          },
          "id": 1209,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "expr": "topk(100, sum by (project_uuid) (((oie_outbound_max_flows_single_remote{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"} / oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}) > bool 0.8) and on (instance_uuid, project_uuid, ip) (oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"} > bool $gvar_oie_min_flows)))",
              "legendFormat": "{{project_uuid}}",
              "refId": "A"
            }
          ],
          "title": "Project Single-Target Dominance",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Threat-intel contact rate per project, split by list type.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Count",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "decimals": 0,
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 24,
            "x": 0,
            "y": 100
          },
          "id": 1210,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "topk(100, sum by (project_uuid, list) (label_replace(increase(oie_tor_exit_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}[5m]), \"list\", \"tor_exit\", \"__name__\", \".*\") or label_replace(increase(oie_tor_relay_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}[5m]), \"list\", \"tor_relay\", \"__name__\", \".*\") or label_replace(increase(oie_spamhaus_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}[5m]), \"list\", \"spamhaus\", \"__name__\", \".*\") or label_replace(increase(oie_emergingthreats_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}[5m]), \"list\", \"emergingthreats\", \"__name__\", \".*\") or label_replace(increase(oie_customlist_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\"}[5m]), \"list\", \"customlist\", \"__name__\", \".*\"))) > 0",
              "legendFormat": "{{project_uuid}} {{list}}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Project Threat Mix (by list)",
          "type": "timeseries"
        }
      ],
      "title": "Project / Tenant Overview (Top 100)",
      "type": "row"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 59
      },
      "id": 28,
      "panels": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Conntrack Flows per Hypervisor.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Conntrack Flows",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": -1,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 4,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 15000
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 60
          },
          "id": 1224,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "disableTextWrap": false,
              "editorMode": "code",
              "expr": "oie_host_conntrack_entries_total{job=\"openstack-instance-exporter\", instance=~\"$gvar_oie_hypervisor\"}",
              "fullMetaSearch": false,
              "includeNullMetadata": true,
              "instant": false,
              "interval": "0",
              "legendFormat": "{{ instance }}",
              "range": true,
              "refId": "A",
              "useBackend": false
            }
          ],
          "title": "Conntrack Flows per Hypervisor",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Total conntrack flows per VM fixed IP. Shown only when flows exceed 3000.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Conntrack Flows",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": -1,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 4,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 15000
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 68
          },
          "id": 30,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "disableTextWrap": false,
              "editorMode": "code",
              "expr": "sum by (instance_uuid, project_uuid, ip) (oie_conntrack_ip_flows_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}) > 3000",
              "fullMetaSearch": false,
              "includeNullMetadata": true,
              "instant": false,
              "interval": "0",
              "legendFormat": "IP: {{ ip }} | Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "A",
              "useBackend": false
            }
          ],
          "title": "Conntrack Flows per Instance (Hot Only)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Top 100 fixed IPs by conntrack flow count over time.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Conntrack Flows",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": -1,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 4,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "decimals": 0,
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "orange",
                    "value": 5000
                  },
                  {
                    "color": "red",
                    "value": 15000
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 76
          },
          "id": 32,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "min",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Last",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "topk(100, oie_conntrack_ip_flows_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"})",
              "legendFormat": "IP {{ ip }} | Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "A",
              "useBackend": false
            }
          ],
          "title": "Conntrack Top IPs (Time Series)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Threat-intel hits over time (only shows VMs with meaningful activity).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Hits per 5m",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": true,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 3,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "orange",
                    "value": 1
                  },
                  {
                    "color": "red",
                    "value": 5
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 24,
            "x": 0,
            "y": 84
          },
          "id": 31,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "disableTextWrap": false,
              "editorMode": "code",
              "expr": "topk(50, sum by (instance_uuid, project_uuid) (\n  increase(oie_tor_exit_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n+ increase(oie_tor_relay_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n+ increase(oie_spamhaus_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n+ increase(oie_emergingthreats_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n+ increase(oie_customlist_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n)) > $gvar_oie_min_contact",
              "legendFormat": "Threat hits | Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Threat Contacts (Hot Only, per VM)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "VMs with large threat-intel bursts in the last hour and still active now.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Hits",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": -1,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 4,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": true,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "decimals": 0,
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 1
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 24,
            "x": 0,
            "y": 93
          },
          "id": 33,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "min",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Last",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "(\n  sum by (instance_uuid, project_uuid) (\n    (increase(oie_tor_exit_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h]) >= bool $gvar_oie_min_contact)\n      * increase(oie_tor_exit_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n  + (increase(oie_tor_relay_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h]) >= bool $gvar_oie_min_contact)\n      * increase(oie_tor_relay_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n  + (increase(oie_spamhaus_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h]) >= bool $gvar_oie_min_contact)\n      * increase(oie_spamhaus_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n  + (increase(oie_emergingthreats_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h]) >= bool $gvar_oie_min_contact)\n      * increase(oie_emergingthreats_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n  + (increase(oie_customlist_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h]) >= bool $gvar_oie_min_contact)\n      * increase(oie_customlist_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n  ) > 100\n)\nand on(instance_uuid, project_uuid)\n(\n  sum by (instance_uuid, project_uuid) (\n    (increase(oie_tor_exit_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m]) >= bool $gvar_oie_min_contact)\n      * increase(oie_tor_exit_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n  + (increase(oie_tor_relay_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m]) >= bool $gvar_oie_min_contact)\n      * increase(oie_tor_relay_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n  + (increase(oie_spamhaus_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m]) >= bool $gvar_oie_min_contact)\n      * increase(oie_spamhaus_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n  + (increase(oie_emergingthreats_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m]) >= bool $gvar_oie_min_contact)\n      * increase(oie_emergingthreats_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n  + (increase(oie_customlist_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m]) >= bool $gvar_oie_min_contact)\n      * increase(oie_customlist_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n  ) > 0\n)\n",
              "legendFormat": "Instance: {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Threat-Intel Contacts (1h total, active now)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "How long each threat list if enabled took to refresh.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Seconds",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.4,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 3,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "normal"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "max": 0.5,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "s"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 10,
            "w": 24,
            "x": 0,
            "y": 102
          },
          "id": 1227,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "{__name__=~\"oie_(tor_exit|tor_relay|spamhaus|emergingthreats|customlist)_refresh_duration_seconds\",job=\"openstack-instance-exporter\",instance=~\"$gvar_oie_hypervisor\"}",
              "legendFormat": "{{ __name__ }} {{ instance }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Threat List Refresh Health",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Error count for each threat list refresh.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Count",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.4,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 3,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "normal"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "max": 0.5,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 24,
            "x": 0,
            "y": 112
          },
          "id": 1228,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "{__name__=~\"oie_(tor_exit|tor_relay|spamhaus|emergingthreats|customlist)_refresh_errors_total\",job=\"openstack-instance-exporter\",instance=~\"$gvar_oie_hypervisor\"}",
              "legendFormat": "Threatlist: {{ __name__ }} | Hypervisor: {{ instance }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Threat List Refresh Error Count",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Each threat lists total addresses.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-greens"
              },
              "decimals": 0,
              "mappings": [],
              "max": 0.5,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 7,
            "w": 24,
            "x": 0,
            "y": 121
          },
          "id": 1229,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "auto",
            "percentChangeColorMode": "standard",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showPercentChange": false,
            "textMode": "auto",
            "wideLayout": true
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "max by (__name__) (\n  {__name__=~\"oie_(tor_exit|tor_relay|spamhaus|emergingthreats|customlist)_entries\"}\n)\n",
              "legendFormat": "__auto",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Threat List Entries Per List",
          "type": "stat"
        }
      ],
      "title": "Conntrack & Threat Metrics",
      "type": "row"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 60
      },
      "id": 61,
      "panels": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "How many unique remote IPs each fixed IP talked to in the last interval (only shown uniques > 50 and flows > 1000).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Remotes",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 4,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 268
          },
          "id": 903,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "repeat": "datasource",
          "repeatDirection": "h",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "(sum by (instance_uuid, project_uuid, ip) (oie_outbound_unique_remotes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}) > 50)\nand on(instance_uuid, project_uuid, ip)\n(sum by (instance_uuid, project_uuid, ip) (oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}) > 1000)",
              "legendFormat": "Unique Remotes | IP {{ ip }} | Instance {{ instance_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Outbound Unique Remotes (per IP)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Total outbound flows per fixed IP in the last interval (only shown when flows > 1k).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Flows",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 4,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 15000
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 0,
            "y": 276
          },
          "id": 905,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "sum by (instance_uuid, project_uuid, ip) (oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}) > 1000",
              "legendFormat": "Outbound Flows | IP {{ ip }} | Instance {{ instance_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Outbound Flows (per IP)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "New remote IPs seen since the last interval (only shown when flows > 500).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "New remotes",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 4,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 12,
            "y": 276
          },
          "id": 904,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "sum by (instance_uuid, project_uuid, ip) (oie_outbound_new_remotes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"})\nand on(instance_uuid, project_uuid, ip)\n(sum by (instance_uuid, project_uuid, ip) (oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}) > 500)",
              "legendFormat": "New Remotes | IP {{ ip }} | Instance {{ instance_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Outbound New Remotes (per IP)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Max flows to any single remote IP per fixed IP (only shown when total flows > 1k).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Flows",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 4,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 15000
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 283
          },
          "id": 906,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "sum by (instance_uuid, project_uuid, ip) (oie_outbound_max_flows_single_remote{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"})\nand on(instance_uuid, project_uuid, ip)\n(sum by (instance_uuid, project_uuid, ip) (oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}) > 1000)",
              "legendFormat": "Max Flows Single Remote | IP {{ ip }} | Instance {{ instance_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Outbound Max Flows Single Remote (per IP)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "How many different destination ports each fixed IP hit in the last interval (only shown when flows > 500).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Ports",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 4,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 8,
            "x": 0,
            "y": 291
          },
          "id": 63,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "sum by (instance_uuid, project_uuid, ip) (oie_outbound_unique_dst_ports{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"})\nand on(instance_uuid, project_uuid, ip)\n(sum by (instance_uuid, project_uuid, ip) (oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}) > 500)",
              "legendFormat": "Unique Dst Ports | IP {{ ip }} | Instance {{ instance_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Outbound Unique Dst Ports (per IP)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "New destination ports since the prior interval (only shown when flows > 500).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "New ports",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 4,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 8,
            "x": 8,
            "y": 291
          },
          "id": 907,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "sum by (instance_uuid, project_uuid, ip) (oie_outbound_new_dst_ports{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"})\nand on(instance_uuid, project_uuid, ip)\n(sum by (instance_uuid, project_uuid, ip) (oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}) > 500)",
              "legendFormat": "New Dst Ports | IP {{ ip }} | Instance {{ instance_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Outbound New Dst Ports (per IP)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Max flows to any single destination port (only shown when total flows > 1k).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Flows",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 4,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 15000
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 8,
            "x": 16,
            "y": 291
          },
          "id": 908,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Max",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "sum by (instance_uuid, project_uuid, ip) (oie_outbound_max_flows_single_dst_port{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"})\nand on(instance_uuid, project_uuid, ip)\n(sum by (instance_uuid, project_uuid, ip) (oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}) > 1000)",
              "legendFormat": "Max Flows Single Dst Port | IP {{ ip }} | Instance {{ instance_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Outbound Max Flows Single Dst Port (per IP)",
          "type": "timeseries"
        }
      ],
      "title": "Outbound Behavior",
      "type": "row"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 61
      },
      "id": 200,
      "panels": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Scan/fan-out candidates: many remotes + many ports + low single-remote dominance + flows gate.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Dominance ratio (<0.3)",
                "axisPlacement": "auto",
                "axisSoftMax": 1,
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 2,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "max": 1,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "orange",
                    "value": 0.3
                  },
                  {
                    "color": "red",
                    "value": 0.5
                  }
                ]
              },
              "unit": "percentunit"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 300
          },
          "id": 201,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "(\n  (oie_outbound_max_flows_single_remote{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}\n   /\n   oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}) < 0.3\n)\nand on(instance_uuid, project_uuid, ip)\n(\n  oie_outbound_unique_remotes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"} > 50\n)\nand on(instance_uuid, project_uuid, ip)\n(\n  oie_outbound_unique_dst_ports{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"} > 50\n)\nand on(instance_uuid, project_uuid, ip)\n(\n  oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"} > $gvar_oie_min_flows\n)\n",
              "legendFormat": "Fan-out candidate | IP {{ ip }} | Instance {{ instance_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Potential Scan / Fan-out (active now)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Single-target dominance candidates: very high share of flows to one remote AND high total flows.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Dominance ratio (>0.8)",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "decimals": 2,
              "mappings": [],
              "max": 1,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "orange",
                    "value": 0.5
                  },
                  {
                    "color": "red",
                    "value": 0.8
                  }
                ]
              },
              "unit": "percentunit"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 300
          },
          "id": 202,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "(\n  (oie_outbound_max_flows_single_remote{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}\n   /\n   oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}) > 0.8\n)\nand on(instance_uuid, project_uuid, ip)\n(\n  oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"} > 2000\n)\n",
              "legendFormat": "Single-target dominance | IP {{ ip }} | Instance {{ instance_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Potential C2 / Single-Target Flood (active now)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "VMs that touched at least two different threat lists in the last 30 minutes.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Lists hit (>=2)",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "stepAfter",
                "lineWidth": 1,
                "pointSize": 1,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": true,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 1
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 308
          },
          "id": 203,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "(\n  sum by (instance_uuid, project_uuid) (\n    (increase(oie_tor_exit_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[30m]) > bool 0)\n  + (increase(oie_tor_relay_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[30m]) > bool 0)\n  + (increase(oie_spamhaus_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[30m]) > bool 0)\n  + (increase(oie_emergingthreats_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[30m]) > bool 0)\n  + (increase(oie_customlist_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[30m]) > bool 0)\n  )\n) >= 2",
              "legendFormat": "Instance {{ instance_uuid }} | Project {{ project_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Multi-List Threat Contact (>=2 lists /30m)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Threat hits per outbound flow over 1h (shows VMs where threat traffic is dense).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Threat / Flow",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 3,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 0.01
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 308
          },
          "id": 204,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "(\n  sum by (instance_uuid, project_uuid) (\n    increase(oie_tor_exit_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n  + increase(oie_tor_relay_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n  + increase(oie_spamhaus_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n  + increase(oie_emergingthreats_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n  + increase(oie_customlist_contact{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n  )\n  /\n  clamp_min(\n    sum by (instance_uuid, project_uuid) (\n      increase(oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1h])\n    ),\n    1\n  )\n) > 0.01",
              "legendFormat": "Instance {{ instance_uuid }} | Project {{ project_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Threat Density (>1% of flows /1h)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "One/small remote set + many ports + enough flows (single-target scan).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Candidate (0/1)",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 3,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 1
                  }
                ]
              },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 316
          },
          "id": 205,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "(oie_outbound_unique_remotes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"} < 3)\nand on(instance_uuid, project_uuid, ip)\n(oie_outbound_unique_dst_ports{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"} > 50)\nand on(instance_uuid, project_uuid, ip)\n(oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"} > $gvar_oie_min_flows)",
              "legendFormat": "IP {{ ip }} | Instance {{ instance_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Single Remote + Many Ports (active now)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Most flows going to one destination port (amplification/brute/stuck-service signal).",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Dominance ratio (>0.7)",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 1,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 0.7
                  }
                ]
              },
              "unit": "percentunit"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 316
          },
          "id": 206,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "(\n  oie_outbound_max_flows_single_dst_port{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}\n  /\n  clamp_min(oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}, 1)\n) > 0.7\nand on(instance_uuid, project_uuid, ip)\n(\n  oie_outbound_flows{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"} > 2000\n)",
              "legendFormat": "IP {{ ip }} | Instance {{ instance_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Single-Port Dominance (active now)",
          "type": "timeseries"
        }
      ],
      "title": "DDoS / C2 Heuristics (Summary Only)",
      "type": "row"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 62
      },
      "id": 19,
      "panels": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "VM CPU usage (5m avg). Shows only when sustained above 75%.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "vCPU Usage",
                "axisPlacement": "auto",
                "axisSoftMax": 100,
                "axisSoftMin": 75,
                "barAlignment": -1,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "decimals": 0,
              "mappings": [],
              "max": 100,
              "min": 75,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "percent"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 24,
            "x": 0,
            "y": 325
          },
          "id": 2,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "mean",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Mean",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "avg_over_time(oie_cpu_percent{instance=~\"$gvar_oie_hypervisor\",project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m]) > 75",
              "legendFormat": "Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "A"
            }
          ],
          "title": "Instance CPU Usage",
          "type": "timeseries"
        }
      ],
      "title": "CPU Usage",
      "type": "row"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 63
      },
      "id": 20,
      "panels": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Disk read/write IOPS over tier thresholds.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "IOPS",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": -1,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "log": 2,
                  "type": "log"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "wps"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 24,
            "x": 0,
            "y": 338
          },
          "id": 13,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "mean",
                "max"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Last",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "irate(oie_disk_w_requests{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\", disk_uuid=~\"$gvar_oie_disk_uuid\"}[1m])\n> on(instance, project_uuid, instance_uuid, disk_uuid)\ngroup_left()\nmax by (instance, project_uuid, instance_uuid, disk_uuid) (\noie_disk_w_alert_threshold{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\", disk_uuid=~\"$gvar_oie_disk_uuid\"}\n)\n",
              "legendFormat": "W | Instance {{ instance_uuid }} | Disk Type: {{ disk_type }} | Disk: {{ disk_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "W"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "irate(oie_disk_r_requests{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\", disk_uuid=~\"$gvar_oie_disk_uuid\"}[1m])\n> on(instance, project_uuid, instance_uuid, disk_uuid)\ngroup_left()\nmax by (instance, project_uuid, instance_uuid, disk_uuid) (\noie_disk_r_alert_threshold{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\", disk_uuid=~\"$gvar_oie_disk_uuid\"}\n)\n",
              "legendFormat": "R | Instance {{ instance_uuid }} | Disk Type: {{ disk_type }} | Disk: {{ disk_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "R"
            }
          ],
          "title": "Disk Read/Write Requests (IOPS)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Disk read/write throughput. Shows when sustained above ~50MB/s over 5 minutes.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Throughput (GB/s)",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": -1,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "log": 2,
                  "type": "log"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "GBs"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 12,
            "x": 0,
            "y": 350
          },
          "id": 15,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Last",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "min_over_time(rate(oie_disk_w_gbytes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\", disk_uuid=~\"$gvar_oie_disk_uuid\"}[5m])[30s:]) > 0.05\n",
              "legendFormat": "W | Instance {{ instance_uuid }} | Disk Type: {{ disk_type }} | Disk: {{ disk_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "W"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "min_over_time(rate(oie_disk_r_gbytes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\", disk_uuid=~\"$gvar_oie_disk_uuid\"}[5m])[30s:]) > 0.05\n",
              "legendFormat": "R | Instance {{ instance_uuid }} | Disk Type: {{ disk_type }} | Disk: {{ disk_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "R"
            }
          ],
          "title": "Disk Read/Write Throughput",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Disk read/write volume spikes.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Gigabytes",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "decgbytes"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 12,
            "x": 12,
            "y": 350
          },
          "id": 11,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "sum"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Last",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "increase(oie_disk_w_gbytes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\", disk_uuid=~\"$gvar_oie_disk_uuid\"}[1m]) > 1\n",
              "legendFormat": "W | Instance {{ instance_uuid }} | Disk Type: {{ disk_type }} | Disk: {{ disk_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "W"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "increase(oie_disk_r_gbytes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\", disk_uuid=~\"$gvar_oie_disk_uuid\"}[1m]) > 1\n",
              "legendFormat": "R | Instance {{ instance_uuid }} | Disk Type: {{ disk_type }} | Disk: {{ disk_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "R"
            }
          ],
          "title": "Disk Read/Write High Usage (GB)",
          "type": "timeseries"
        }
      ],
      "title": "Disk Usage Metrics",
      "type": "row"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 64
      },
      "id": 21,
      "panels": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Network packet-rate bursts: >3k pps sustained for 1+ minute.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "last"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Packets/s",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  }
                ]
              },
              "unit": "pps"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 12,
            "x": 0,
            "y": 327
          },
          "id": 5,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "min_over_time(rate(oie_net_rx_pkt_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])[1m:]) > 3000\n",
              "legendFormat": "RX | Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "RX"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "min_over_time(rate(oie_net_tx_pkt_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])[1m:]) > 3000\n",
              "legendFormat": "TX | Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "TX"
            }
          ],
          "title": "Network RX/TX Packets PPS",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Network RX/TX throughput bursts: >125Mbit/s sustained for more than 5 minutes.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "min"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Gbit/s",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "Gbits"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 12,
            "x": 12,
            "y": 327
          },
          "id": 17,
          "options": {
            "legend": {
              "calcs": [
                "lastNotNull",
                "max",
                "mean"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "min_over_time((rate(oie_net_rx_gbytes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1m]) * 8)[5m:]) > 0.125\n",
              "legendFormat": "RX | Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "RX"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "min_over_time((rate(oie_net_tx_gbytes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1m]) * 8)[5m:]) > 0.125\n",
              "legendFormat": "TX | Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "TX"
            }
          ],
          "title": "Network RX/TX Throughput",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Network RX/TX volume spikes: > 5GB transferred in 5 minutes per VM.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Gigabytes",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  }
                ]
              },
              "unit": "decgbytes"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 24,
            "x": 0,
            "y": 339
          },
          "id": 4,
          "options": {
            "legend": {
              "calcs": [
                "last",
                "max",
                "sum"
              ],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true,
              "sortBy": "Last",
              "sortDesc": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "min_over_time( (rate(oie_net_rx_gbytes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1m]) * 8)[5m:] ) > 0.125",
              "legendFormat": "RX | Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "RX"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "min_over_time( (rate(oie_net_tx_gbytes{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[1m]) * 8)[5m:] ) > 0.125",
              "legendFormat": "TX | Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "TX"
            }
          ],
          "title": "Network RX/TX Usage",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Dropped packets per second (RX), averaged over 5m. Filtered to show only if drop ratio > 0.01%.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Drops/s",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 12,
            "x": 0,
            "y": 351
          },
          "id": 7,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "(\nrate(oie_net_rx_drp_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n/\nrate(oie_net_rx_pkt_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n) > 1e-4\n",
              "legendFormat": "RX | Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "RX"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "(\nrate(oie_net_tx_drp_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n/\nrate(oie_net_tx_pkt_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n) > 1e-4\n",
              "legendFormat": "TX | Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "TX"
            }
          ],
          "title": "Network RX/TX Dropped Packets",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "description": "Packet errors per second, averaged over 5m. Filtered to show only if > 0.01 errors/sec.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-GrYlRd",
                "seriesBy": "max"
              },
              "custom": {
                "axisBorderShow": true,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Errors/s",
                "axisPlacement": "auto",
                "axisSoftMin": 0,
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "never",
                "showValues": false,
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": 0
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 12,
            "x": 12,
            "y": 351
          },
          "id": 9,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "table",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "hideZeros": false,
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "12.3.0",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "(\nrate(oie_net_rx_er_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n/\nrate(oie_net_rx_pkt_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n) > 1e-5\n",
              "legendFormat": "RX | Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "RX"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "${datasource}"
              },
              "editorMode": "code",
              "expr": "(\nrate(oie_net_tx_er_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n/\nrate(oie_net_tx_pkt_total{instance=~\"$gvar_oie_hypervisor\", project_uuid=~\"$gvar_oie_project_uuid\", instance_uuid=~\"$gvar_oie_instance_uuid\"}[5m])\n) > 1e-5\n",
              "legendFormat": "TX | Instance {{ instance_uuid }} | Project: {{ project_uuid }}",
              "range": true,
              "refId": "TX"
            }
          ],
          "title": "Network RX/TX Packet Errors",
          "type": "timeseries"
        }
      ],
      "title": "Network Usage Metrics",
      "type": "row"
    }
  ],
  "preload": false,
  "refresh": "10s",
  "schemaVersion": 42,
  "tags": [
    "openstack",
    "openstack_instance_exporter"
  ],
  "templating": {
    "list": [
      {
        "current": {
          "text": "3",
          "value": "3"
        },
        "hide": 2,
        "label": "Min Contact Hits",
        "name": "gvar_oie_min_contact",
        "query": "3",
        "skipUrlSync": true,
        "type": "constant"
      },
      {
        "current": {
          "text": "1000",
          "value": "1000"
        },
        "hide": 2,
        "label": "Min Outbound Flows",
        "name": "gvar_oie_min_flows",
        "query": "1000",
        "skipUrlSync": true,
        "type": "constant"
      },
      {
        "current": {
          "text": [
            "All"
          ],
          "value": [
            "$__all"
          ]
        },
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "definition": "label_values(oie_instance_info,instance)",
        "includeAll": true,
        "label": "Hypervisor",
        "multi": true,
        "name": "gvar_oie_hypervisor",
        "options": [],
        "query": {
          "qryType": 1,
          "query": "label_values(oie_instance_info,instance)",
          "refId": "PrometheusVariableQueryEditor-VariableQuery"
        },
        "refresh": 1,
        "regex": "/.*/",
        "sort": 2,
        "type": "query"
      },
      {
        "current": {
          "text": [
            "All"
          ],
          "value": [
            "$__all"
          ]
        },
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "definition": "label_values({instance=~\"$gvar_oie_hypervisor\"},project_uuid)",
        "includeAll": true,
        "label": "Project UUID",
        "multi": true,
        "name": "gvar_oie_project_uuid",
        "options": [],
        "query": {
          "qryType": 1,
          "query": "label_values({instance=~\"$gvar_oie_hypervisor\"},project_uuid)",
          "refId": "PrometheusVariableQueryEditor-VariableQuery"
        },
        "refresh": 1,
        "regex": "/.*/",
        "sort": 2,
        "type": "query"
      },
      {
        "current": {
          "text": [
            "All"
          ],
          "value": [
            "$__all"
          ]
        },
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "definition": "label_values({project_uuid=~\"$gvar_oie_project_uuid\"},instance_uuid)",
        "includeAll": true,
        "label": "Instance UUID",
        "multi": true,
        "name": "gvar_oie_instance_uuid",
        "options": [],
        "query": {
          "qryType": 1,
          "query": "label_values({project_uuid=~\"$gvar_oie_project_uuid\"},instance_uuid)",
          "refId": "PrometheusVariableQueryEditor-VariableQuery"
        },
        "refresh": 1,
        "regex": "/.*/",
        "sort": 2,
        "type": "query"
      },
      {
        "current": {
          "text": "All",
          "value": "$__all"
        },
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "definition": "label_values(oie_disk_info,disk_uuid)",
        "includeAll": true,
        "label": "Disk UUID",
        "multi": true,
        "name": "gvar_oie_disk_uuid",
        "options": [],
        "query": {
          "qryType": 1,
          "query": "label_values(oie_disk_info,disk_uuid)",
          "refId": "PrometheusVariableQueryEditor-VariableQuery"
        },
        "refresh": 1,
        "regex": "/.*/",
        "sort": 2,
        "type": "query"
      },
      {
        "current": {
          "text": "Prometheus",
          "value": "${datasource}"
        },
        "includeAll": false,
        "label": "Datasource",
        "name": "datasource",
        "options": [],
        "query": "prometheus",
        "refresh": 1,
        "regex": "",
        "type": "datasource"
      }
    ]
  },
  "time": {
    "from": "now-7d",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "browser",
  "title": "OpenStack Instance Exporter",
  "uid": "fdnvwgpq7hqm8f",
  "version": 1
}